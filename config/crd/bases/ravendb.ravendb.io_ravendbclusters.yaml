---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.15.0
  name: ravendbclusters.ravendb.ravendb.io
spec:
  group: ravendb.ravendb.io
  names:
    kind: RavenDBCluster
    listKind: RavenDBClusterList
    plural: ravendbclusters
    singular: ravendbcluster
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            properties:
              certsSecretRef:
                type: string
              domain:
                minLength: 1
                type: string
              email:
                pattern: ^[^@\s]+@[^@\s]+\.[^@\s]+$
                type: string
              env:
                additionalProperties:
                  type: string
                type: object
              environment:
                additionalProperties:
                  type: string
                type: object
              externalAccessConfiguration:
                properties:
                  awsExternalAccessContext:
                    type: object
                  ingressControllerContext:
                    properties:
                      additionalAnnotations:
                        additionalProperties:
                          type: string
                        type: object
                      ingressClassName:
                        enum:
                        - nginx
                        minLength: 1
                        type: string
                    required:
                    - ingressClassName
                    type: object
                  type:
                    enum:
                    - aws
                    - ingress-controller
                    type: string
                required:
                - type
                type: object
              image:
                minLength: 1
                type: string
              imagePullPolicy:
                enum:
                - Always
                - IfNotPresent
                - Never
                type: string
              licenseSecretRef:
                type: string
              mode:
                enum:
                - LetsEncrypt
                - None
                type: string
              nodes:
                items:
                  properties:
                    certsSecretRef:
                      type: string
                    publicServerUrl:
                      minLength: 1
                      type: string
                    publicServerUrlTcp:
                      minLength: 1
                      type: string
                    tag:
                      maxLength: 4
                      minLength: 1
                      type: string
                  required:
                  - publicServerUrl
                  - publicServerUrlTcp
                  - tag
                  type: object
                minItems: 1
                type: array
              storage:
                properties:
                  additionalVolumes:
                    items:
                      properties:
                        mountPath:
                          type: string
                        name:
                          description: 'TODO: verify uniqness of name across all volumes
                            via webhook'
                          type: string
                        subPath:
                          type: string
                        volumeSource:
                          description: 'TODO:  Only one field must be set -> webhook.'
                          properties:
                            configMap:
                              description: |-
                                Adapts a ConfigMap into a volume.


                                The contents of the target ConfigMap's Data field will be presented in a
                                volume as files using the keys in the Data field as the file names, unless
                                the items element is populated with specific mappings of keys to paths.
                                ConfigMap volumes support ownership management and SELinux relabeling.
                              properties:
                                defaultMode:
                                  description: |-
                                    defaultMode is optional: mode bits used to set permissions on created files by default.
                                    Must be an octal value between 0000 and 0777 or a decimal value between 0 and 511.
                                    YAML accepts both octal and decimal values, JSON requires decimal values for mode bits.
                                    Defaults to 0644.
                                    Directories within the path are not affected by this setting.
                                    This might be in conflict with other options that affect the file
                                    mode, like fsGroup, and the result can be other mode bits set.
                                  format: int32
                                  type: integer
                                items:
                                  description: |-
                                    items if unspecified, each key-value pair in the Data field of the referenced
                                    ConfigMap will be projected into the volume as a file whose name is the
                                    key and content is the value. If specified, the listed keys will be
                                    projected into the specified paths, and unlisted keys will not be
                                    present. If a key is specified which is not present in the ConfigMap,
                                    the volume setup will error unless it is marked optional. Paths must be
                                    relative and may not contain the '..' path or start with '..'.
                                  items:
                                    description: Maps a string key to a path within
                                      a volume.
                                    properties:
                                      key:
                                        description: key is the key to project.
                                        type: string
                                      mode:
                                        description: |-
                                          mode is Optional: mode bits used to set permissions on this file.
                                          Must be an octal value between 0000 and 0777 or a decimal value between 0 and 511.
                                          YAML accepts both octal and decimal values, JSON requires decimal values for mode bits.
                                          If not specified, the volume defaultMode will be used.
                                          This might be in conflict with other options that affect the file
                                          mode, like fsGroup, and the result can be other mode bits set.
                                        format: int32
                                        type: integer
                                      path:
                                        description: |-
                                          path is the relative path of the file to map the key to.
                                          May not be an absolute path.
                                          May not contain the path element '..'.
                                          May not start with the string '..'.
                                        type: string
                                    required:
                                    - key
                                    - path
                                    type: object
                                  type: array
                                  x-kubernetes-list-type: atomic
                                name:
                                  default: ""
                                  description: |-
                                    Name of the referent.
                                    This field is effectively required, but due to backwards compatibility is
                                    allowed to be empty. Instances of this type with an empty value here are
                                    almost certainly wrong.
                                    TODO: Add other useful fields. apiVersion, kind, uid?
                                    More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                                    TODO: Drop `kubebuilder:default` when controller-gen doesn't need it https://github.com/kubernetes-sigs/kubebuilder/issues/3896.
                                  type: string
                                optional:
                                  description: optional specify whether the ConfigMap
                                    or its keys must be defined
                                  type: boolean
                              type: object
                              x-kubernetes-map-type: atomic
                            persistentVolumeClaim:
                              description: |-
                                PersistentVolumeClaimVolumeSource references the user's PVC in the same namespace.
                                This volume finds the bound PV and mounts that volume for the pod. A
                                PersistentVolumeClaimVolumeSource is, essentially, a wrapper around another
                                type of volume that is owned by someone else (the system).
                              properties:
                                claimName:
                                  description: |-
                                    claimName is the name of a PersistentVolumeClaim in the same namespace as the pod using this volume.
                                    More info: https://kubernetes.io/docs/concepts/storage/persistent-volumes#persistentvolumeclaims
                                  type: string
                                readOnly:
                                  description: |-
                                    readOnly Will force the ReadOnly setting in VolumeMounts.
                                    Default false.
                                  type: boolean
                              required:
                              - claimName
                              type: object
                            secret:
                              description: |-
                                Adapts a Secret into a volume.


                                The contents of the target Secret's Data field will be presented in a volume
                                as files using the keys in the Data field as the file names.
                                Secret volumes support ownership management and SELinux relabeling.
                              properties:
                                defaultMode:
                                  description: |-
                                    defaultMode is Optional: mode bits used to set permissions on created files by default.
                                    Must be an octal value between 0000 and 0777 or a decimal value between 0 and 511.
                                    YAML accepts both octal and decimal values, JSON requires decimal values
                                    for mode bits. Defaults to 0644.
                                    Directories within the path are not affected by this setting.
                                    This might be in conflict with other options that affect the file
                                    mode, like fsGroup, and the result can be other mode bits set.
                                  format: int32
                                  type: integer
                                items:
                                  description: |-
                                    items If unspecified, each key-value pair in the Data field of the referenced
                                    Secret will be projected into the volume as a file whose name is the
                                    key and content is the value. If specified, the listed keys will be
                                    projected into the specified paths, and unlisted keys will not be
                                    present. If a key is specified which is not present in the Secret,
                                    the volume setup will error unless it is marked optional. Paths must be
                                    relative and may not contain the '..' path or start with '..'.
                                  items:
                                    description: Maps a string key to a path within
                                      a volume.
                                    properties:
                                      key:
                                        description: key is the key to project.
                                        type: string
                                      mode:
                                        description: |-
                                          mode is Optional: mode bits used to set permissions on this file.
                                          Must be an octal value between 0000 and 0777 or a decimal value between 0 and 511.
                                          YAML accepts both octal and decimal values, JSON requires decimal values for mode bits.
                                          If not specified, the volume defaultMode will be used.
                                          This might be in conflict with other options that affect the file
                                          mode, like fsGroup, and the result can be other mode bits set.
                                        format: int32
                                        type: integer
                                      path:
                                        description: |-
                                          path is the relative path of the file to map the key to.
                                          May not be an absolute path.
                                          May not contain the path element '..'.
                                          May not start with the string '..'.
                                        type: string
                                    required:
                                    - key
                                    - path
                                    type: object
                                  type: array
                                  x-kubernetes-list-type: atomic
                                optional:
                                  description: optional field specify whether the
                                    Secret or its keys must be defined
                                  type: boolean
                                secretName:
                                  description: |-
                                    secretName is the name of the secret in the pod's namespace to use.
                                    More info: https://kubernetes.io/docs/concepts/storage/volumes#secret
                                  type: string
                              type: object
                          type: object
                      required:
                      - mountPath
                      - name
                      - volumeSource
                      type: object
                    type: array
                  data:
                    properties:
                      accessModes:
                        description: |-
                          todo: reject ReadWriteMany for poupular storage via dict
                          we should log a warning for unknown StorageClass names + RWX combo but still allow it. --> webhook
                        items:
                          type: string
                        type: array
                      size:
                        pattern: ^\d+(Ei|Pi|Ti|Gi|Mi|Ki)$
                        type: string
                      storageClassName:
                        type: string
                      volumeAttributesClassName:
                        type: string
                    required:
                    - size
                    type: object
                  logs:
                    properties:
                      audit:
                        properties:
                          accessModes:
                            description: |-
                              todo: reject ReadWriteMany for poupular storage via dict
                              we should log a warning for unknown StorageClass names + RWX combo but still allow it. --> webhook
                            items:
                              type: string
                            type: array
                          path:
                            type: string
                          size:
                            pattern: ^\d+(Ei|Pi|Ti|Gi|Mi|Ki)$
                            type: string
                          storageClassName:
                            type: string
                          volumeAttributesClassName:
                            type: string
                        required:
                        - size
                        type: object
                      ravendb:
                        properties:
                          accessModes:
                            description: |-
                              todo: reject ReadWriteMany for poupular storage via dict
                              we should log a warning for unknown StorageClass names + RWX combo but still allow it. --> webhook
                            items:
                              type: string
                            type: array
                          path:
                            type: string
                          size:
                            pattern: ^\d+(Ei|Pi|Ti|Gi|Mi|Ki)$
                            type: string
                          storageClassName:
                            type: string
                          volumeAttributesClassName:
                            type: string
                        required:
                        - size
                        type: object
                    type: object
                required:
                - data
                type: object
            required:
            - domain
            - image
            - imagePullPolicy
            - licenseSecretRef
            - mode
            - storage
            type: object
          status:
            properties:
              message:
                type: string
              nodes:
                items:
                  properties:
                    status:
                      type: string
                    tag:
                      type: string
                  required:
                  - status
                  - tag
                  type: object
                type: array
              phase:
                enum:
                - Deploying
                - Running
                - Error
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
